<html>
  <head>
    <link rel="stylesheet" href="https://js.arcgis.com/4.15/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.15/"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ArcGIS JavaScript Tutorials: Create a JavaScript starter app</title>
    <style>
      html, body, #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>
    <script>
        require([
      "esri/Map",
      "esri/views/MapView",
      "esri/views/SceneView",
      "esri/layers/FeatureLayer",
      "esri/widgets/TimeSlider",
        "esri/widgets/Expand",
        "esri/widgets/Legend",
        "esri/layers/GeoJSONLayer"
    ], function(Map, MapView, SceneView, FeatureLayer, TimeSlider, Expand, Legend, GeoJSONLayer) {
      let layerView;


      const testLayer = new FeatureLayer({
      portalItem: {
        id: "68b4956f741949588884fe83210bd0d3",
        portal: {
          url: "https://mmspgc-gis.mmspgc.local/portal"
        }
      },
      timeInfo: {
            startField: "StartDate", // name of the date field
            interval: {
              // set time interval to one day
              unit: "days",
              value: 1
            }
      }
    });

    const map = new Map({
      basemap: "topo-vector"
    });
    map.ground.surfaceColor = "#FFFF";
    map.ground.opacity = 0;

    var view = new SceneView({
      container: "viewDiv",
      map: map,
      center: [121.0521583, 14.6480284],
      zoom: 15
    });

    view.map.add(testLayer);


    const timeSlider = new TimeSlider({
          container: "timeSlider",
          playRate: 50,
          mode: "cumulative-from-start",
      stops: {
        interval: {
          value: 1,
          unit: "hours"
        }
      },
        });
        view.ui.add(timeSlider, "manual");

        // wait till the layer view is loaded
        view.whenLayerView(testLayer).then(function(lv) {
          layerView = lv;

          // start time of the time slider - 5/25/2019
          const start = new Date(2020, 5, 1);
          // set time slider's full extent to
          // 5/25/5019 - until end date of layer's fullTimeExtent
          timeSlider.fullTimeExtent = {
            start: start,
            end: testLayer.timeInfo.fullTimeExtent.end
          };

          // We will be showing earthquakes with one day interval
          // when the app is loaded we will show earthquakes that
          // happened between 5/25 - 5/26.
          const end = new Date(2020, 6, 7);

          // Values property is set so that timeslider
          // widget show the first day. We are setting
          // the thumbs positions.
          timeSlider.values = [start, end];
        });

        // watch for time slider timeExtent change
        timeSlider.watch("timeExtent", function() {

          // now gray out earthquakes that happened before the time slider's current
          // timeExtent... leaving footprint of earthquakes that already happened
          layerView.effect = {
            filter: {
              timeExtent: timeSlider.timeExtent,
              geometry: view.extent
            },
            excludedEffect: "grayscale(20%) opacity(12%)"
          };

  });

    });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
    <div id="timeSlider"></div>
  </body>
</html>